digraph PropertyScraperArchitecture {
  rankdir=TB;
  node [shape=box, style=rounded];

  browser_list [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/chrome.png"/></TD>
          <TD>Web browser for property list scraping</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05"
  ];
  listing_scraper [label="propertyListingIdealistaScraper", style="rounded,filled", fillcolor="#80ff80"];
  rabbitmq1 [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/rabbitMq.png"/></TD>
          <TD ALIGN="LEFT">Rabbit<BR/>(property-listing-urls queue)</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05"
  ];
  rabbitmq2 [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/rabbitMq.png"/></TD>
          <TD ALIGN="LEFT">Rabbit<BR/>(outgoing-notification-messages queue)</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05"
  ];
  detail_scraper [label="propertyDetailIdealistaScraper", group="detail_column", style="rounded,filled", fillcolor="#80ff80"];
  mongodb [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/mongoDB.png"/></TD>
          <TD>MongoDB</TD>
        </TR>
      </TABLE>
    >,
    group="detail_column",
    margin="0.08,0.05"
  ];
  browser_detail [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/chrome.png"/></TD>
          <TD>Web browser for property detail scraping</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05"
  ];
  notification_message_sender [label="notificationMessageSender", style="rounded,filled", fillcolor="#80ff80"];
  whatsapp [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/whatsapp.png"/></TD>
          <TD>Whatsapp</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05"
  ];
  prometheus [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/prometheus.png"/></TD>
          <TD>Prometheus</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05",
    color=darkgreen
  ];
  grafana [
    label=<
      <TABLE BORDER="0" CELLBORDER="0" CELLPADDING="2" CELLSPACING="0">
        <TR>
          <TD FIXEDSIZE="TRUE" WIDTH="20" HEIGHT="20"><IMG SRC="doc/architecture/grafana.png"/></TD>
          <TD>Grafana</TD>
        </TR>
      </TABLE>
    >,
    margin="0.08,0.05",
    color=darkgreen
  ];

  { rank=same; browser_list; browser_detail; }
  { rank=same; listing_scraper; rabbitmq1; detail_scraper; }
  { rank=same; mongodb; }

  browser_list -> listing_scraper;
  browser_detail -> detail_scraper;
  listing_scraper -> rabbitmq1 [minlen=2];
  rabbitmq1 -> detail_scraper [minlen=2];
  listing_scraper -> browser_list [color=blue];
  detail_scraper -> browser_detail [color=blue];
  detail_scraper -> mongodb [minlen=2];
  mongodb -> detail_scraper [minlen=2];
  detail_scraper -> rabbitmq2;
  rabbitmq2 -> notification_message_sender;
  notification_message_sender -> whatsapp;
  listing_scraper -> prometheus [color=darkgreen];
  detail_scraper -> prometheus [color=darkgreen];
  notification_message_sender -> prometheus [color=darkgreen];
  prometheus -> grafana [color=darkgreen];
}
